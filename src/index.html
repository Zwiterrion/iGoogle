<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<script src="js/jquery-1.11.0.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="date_heure.js"></script>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>


	<!-- Bootstrap core CSS -->
	<link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">

	<link href="../bootstrap/css/style.css" rel="stylesheet">

	<title>iGoogle</title>
	<style>#map_canvas {
		height: 300px;
		width: 300px;
	}
	</style>

	<script type="text/javascript">

	function DateWidget() {

		this.date = date_heure();
	}

	var listDateWidget = [];

	function addDateWidget() {

		var div = document.createElement('div');
		var span = document.createElement('span');
		var date = new DateWidget;
		span.innerHTML = date.date;
		span.setAttribute('id', "widget-" + listDateWidget.length);
		listDateWidget.push(date);

		var buttonDelete = document.createElement('input');
		buttonDelete.setAttribute("class", "btn-danger");
		buttonDelete.setAttribute("type", "button");
		//buttonDelete.setAttribute("onclick", "deleteDateWidget(this)");
		buttonDelete.setAttribute("value", "Supprimer le widget");

		div.appendChild(span);
		div.appendChild(buttonDelete);

		var tbody = document.getElementById("tableBody");
		var tr = document.createElement('tr');
		var td = document.createElement('td');
		td.appendChild(div);
		tr.appendChild(td);
		tbody.appendChild(tr);
		
		refresh();
	}

	function addTwitter()
	{
		var content = '<a class="twitter-timeline" href="https://twitter.com/MichelBillaud" data-widget-id="579937972377796608" style="display:block">Tweets de @MichelBillaud</a>';
		!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
		var newContainer = '';
		newContainer +='<div class="panel-body text-center">' + content + '</div>';
		document.getElementById('tableBody').innerHTML += newContainer;
	}

	
	function addTwitterWidget() {

		var div = document.createElement('div');
		var a = document.createElement('a');
		a.setAttribute('class', "twitter-timeline");
		a.setAttribute('width', "400");
		a.setAttribute('height', "400");
		a.setAttribute('href', "https://twitter.com/MichelBillaud/");
		a.setAttribute('data-widget-id', "579937972377796608");
		a.innerHTML = "Tweets favoris de @MichelBillaud";


		var buttonDelete = document.createElement('input');
		buttonDelete.setAttribute("class", "btn-danger");
		buttonDelete.setAttribute("type", "button");
		//buttonDelete.setAttribute("onclick", "deleteDateWidget(this)");
		buttonDelete.setAttribute("value", "Supprimer le widget");

		div.appendChild(a);
		div.appendChild(buttonDelete);

		var tbody = document.getElementById("tableBody");
		var tr = document.createElement('tr');
		var td = document.createElement('td');
		td.appendChild(div);
		tr.appendChild(td);
		tbody.appendChild(tr);
	}
	function refresh() {
		for(var i=0; i < listDateWidget.length; i++)  {
			document.getElementById("widget-" + i).innerHTML = date_heure();
		}
		setTimeout(refresh, 1000);
	}

	function addGoogleMaps()
	{
		generateMap();
		/*
		var content = '<button onClick="generateMap()" class="btn btn-default" type="button">Go!</button>';
		var newContainer = '<div class="panel panel-default">' + content + '</div>';
		document.getElementById('tableBody').innerHTML += newContainer;
		*/
	}
	// GOOGLE MAPS //
	var map;
	var directionsService = new google.maps.DirectionsService();
	var directionsDisplay = new google.maps.DirectionsRenderer({ 'map': map }); 
	function initialize() {
		var myOptions = {
			zoom: 14,
			center: new google.maps.LatLng(44.791072,-0.608658),
			mapTypeId: google.maps.MapTypeId.ROADMAP
		};
		map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);
		directionsDisplay.setMap(map);
	}
	function generateMap() {
		initialize();
		var start = document.getElementById('maps-input').value;
		var end = '15, rue de Naudet, Gradignan'
		var request = {
			origin:start,
			destination:end,
			travelMode: google.maps.TravelMode.DRIVING
		};
		directionsService.route(request, function(response, status) {
			if (status == google.maps.DirectionsStatus.OK) {
				directionsDisplay.setDirections(response);
			}
		});
	}
    // END GOOGLE MAPS


   /* <iframe id="ytplayer" type="text/html" width="600" height="400" src="http://www.youtube.com/embed?listType=search&list=lol"frameborder="0" />
   */
   function addYoutubeWidget() {

   	var div = document.createElement('div');
   	var iframe = document.createElement('iframe');
   	iframe.setAttribute('id', "ytplayer");
   	iframe.setAttribute('type', "text/html");
   	iframe.setAttribute('width', "600");
   	iframe.setAttribute('height', "400");
   	iframe.setAttribute('src', "http://www.youtube.com/embed?listType=search&list=lol");
   	iframe.setAttribute('frameborder', "O");

   	var buttonDelete = document.createElement('input');
   	buttonDelete.setAttribute("class", "btn-danger");
   	buttonDelete.setAttribute("type", "button");
		//buttonDelete.setAttribute("onclick", "deleteDateWidget(this)");
		buttonDelete.setAttribute("value", "Supprimer le widget");

		div.appendChild(iframe);
		div.appendChild(buttonDelete);

		var tbody = document.getElementById("tableBody");
		var tr = document.createElement('tr');
		var td = document.createElement('td');
		td.appendChild(div);
		tr.appendChild(td);
		tbody.appendChild(tr);

	}

	function load_json(api_url)
	{ 
		var xhr;
		if(window.XMLHttpRequest)
		{
			xhr=new XMLHttpRequest();
		}
		else
		{
			xhr=new ActiveXObject("Microsoft.XMLHTTP");

		}	
		xhr.open("GET",api_url,false);
		xhr.send();
		return xhr.responseText;
	}
	function chargeWeather() {
		var weather = load_json("http://api.openweathermap.org/data/2.5/weather?q=Paris,fr");
		var json = JSON.parse(weather);
		console.log(json.name);
		console.log(json.weather[0].description);
	}

	chargeWeather();

	</script>
</head>

<body>

	<div class="container">
		<!-- Static navbar -->
		<nav class="navbar navbar-default">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="">Project name</a>
				</div>
				<div id="navbar" class="navbar-collapse collapse">
					<ul class="nav navbar-nav">
						<li><a href="#" onclick="addDateWidget()">DateWidget</a></li>
						<li><a href="#" onclick="addTwitter()">TwitterWidget</a></li>
						<li><a href="#" onclick="addYoutubeWidget()">YoutubeWidget</a></li>
						<li><a href="#" onclick="addGoogleMaps()">GoogleMaps</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</div>
	
	<div class="container">
		
		<table id="tableWidget" width="100%" cellspacing="0" cellpadding="0" border="0">
			<tbody id="tableBody">
				
			</tbody>
		</table> 

		<span id="date_heure"></span>
		<div id="cadre2">
			<div id="requete">
				<form method="post">
					<input id="maps-input" type="text"><input name="Aller" type="button" value="Rechercher" onclick="addGoogleMaps()">
				</form>
			</div>
			
		</div>
		<div id="map_canvas"> </div>
	</div> <!-- END CONTAINER -->

	<script src="http://code.jquery.com/jquery.js"></script>
	<script src="../bootstrap/js/bootstrap.min.js"></script>

	<script src="../bootstrap/js/dropdown.js"></script>
</body>
</html>

